# Copyright 2024 Google LLC

# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.  

# You may obtain a copy of the License at

#  https://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing, software
# distributed  
# under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing  
# permissions and
# limitations under the License.
query ListUsers @auth(level: NO_ACCESS) {
  users { uid, name, email: address }
}

query GetUidByEmail($emails: [String!]) @auth(level: PUBLIC) {
  users(where: { address: { in: $emails } }) {
    uid email: address
  }
}

query ListInbox(
  $uid: String
) @auth(level: PUBLIC) {
  emails(where: {
    users_via_Recipient: { 
      exist: { uid: { eq: $uid }
    }}
  }) {
    id subject date 
    content: text 
    sender: from { name email: address uid }
    to: recipients_on_email {
      user { name email: address uid }
    }
  }
}

query ListSent(
  $uid: String
) @auth(level: PUBLIC) {
  emails(where: { 
    fromUid: { eq: $uid }
  }) {
    id subject date 
    content: text 
    sender: from { name email: address uid }
    to: recipients_on_email {
      user { name email: address uid }
    }
  }
}
